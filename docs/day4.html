<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Tag 4 Statistische Tests und Power | Einführung in die Datenauswertung mit R</title>
  <meta name="description" content="Datenauswertung für Biochemiker, eine Einführung mit R" />
  <meta name="generator" content="bookdown 0.20 and GitBook 2.6.7" />

  <meta property="og:title" content="Tag 4 Statistische Tests und Power | Einführung in die Datenauswertung mit R" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Datenauswertung für Biochemiker, eine Einführung mit R" />
  <meta name="github-repo" content="jannikbuhr/dataIntro19" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Tag 4 Statistische Tests und Power | Einführung in die Datenauswertung mit R" />
  
  <meta name="twitter:description" content="Datenauswertung für Biochemiker, eine Einführung mit R" />
  

<meta name="author" content="Jannik Buhr" />


<meta name="date" content="2020-11-22" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="day3.html"/>
<link rel="next" href="day5.html"/>
<script src="libs/header-attrs/header-attrs.js"></script>
<script src="libs/jquery/jquery.min.js"></script>
<link href="libs/gitbook/css/style.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="https://jmbuhr.de/dataIntro19/">Einführung in die Datenauswertung mit R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Prolog</a>
<ul>
<li class="chapter" data-level="0.1" data-path="index.html"><a href="index.html#vorbereitung-auf-den-kurs"><i class="fa fa-check"></i><b>0.1</b> Vorbereitung auf den Kurs</a></li>
<li class="chapter" data-level="0.2" data-path="index.html"><a href="index.html#aufbau-des-kurses"><i class="fa fa-check"></i><b>0.2</b> Aufbau des Kurses</a></li>
<li class="chapter" data-level="0.3" data-path="index.html"><a href="index.html#inhalt-des-kurses"><i class="fa fa-check"></i><b>0.3</b> Inhalt des Kurses</a></li>
<li class="chapter" data-level="0.4" data-path="index.html"><a href="index.html#resourcen"><i class="fa fa-check"></i><b>0.4</b> Resourcen</a>
<ul>
<li class="chapter" data-level="0.4.1" data-path="index.html"><a href="index.html#tidyverse"><i class="fa fa-check"></i><b>0.4.1</b> Tidyverse</a></li>
<li class="chapter" data-level="0.4.2" data-path="index.html"><a href="index.html#allgemein-r"><i class="fa fa-check"></i><b>0.4.2</b> Allgemein R</a></li>
<li class="chapter" data-level="0.4.3" data-path="index.html"><a href="index.html#statistic"><i class="fa fa-check"></i><b>0.4.3</b> Statistic</a></li>
<li class="chapter" data-level="0.4.4" data-path="index.html"><a href="index.html#talks-podcasts-blogs"><i class="fa fa-check"></i><b>0.4.4</b> Talks, Podcasts, Blogs</a></li>
<li class="chapter" data-level="0.4.5" data-path="index.html"><a href="index.html#misc"><i class="fa fa-check"></i><b>0.4.5</b> Misc</a></li>
</ul></li>
<li class="chapter" data-level="0.5" data-path="index.html"><a href="index.html#sonstige-quellen"><i class="fa fa-check"></i><b>0.5</b> Sonstige Quellen</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="day1.html"><a href="day1.html"><i class="fa fa-check"></i><b>1</b> Los Geht’s</a>
<ul>
<li class="chapter" data-level="1.1" data-path="day1.html"><a href="day1.html#grundlegend-strukturen-in-r"><i class="fa fa-check"></i><b>1.1</b> Grundlegend Strukturen in R</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="day1.html"><a href="day1.html#rechnen"><i class="fa fa-check"></i><b>1.1.1</b> Rechnen</a></li>
<li class="chapter" data-level="1.1.2" data-path="day1.html"><a href="day1.html#funktionen-und-vektoren"><i class="fa fa-check"></i><b>1.1.2</b> Funktionen und Vektoren</a></li>
<li class="chapter" data-level="1.1.3" data-path="day1.html"><a href="day1.html#datenstrukturen"><i class="fa fa-check"></i><b>1.1.3</b> Datenstrukturen</a></li>
<li class="chapter" data-level="1.1.4" data-path="day1.html"><a href="day1.html#die-ersten-plots"><i class="fa fa-check"></i><b>1.1.4</b> Die ersten Plots</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="day1.html"><a href="day1.html#project-based-workflow"><i class="fa fa-check"></i><b>1.2</b> Project-based Workflow</a></li>
<li class="chapter" data-level="1.3" data-path="day1.html"><a href="day1.html#packages-das-tidyverse"><i class="fa fa-check"></i><b>1.3</b> Packages: Das Tidyverse</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="day2.html"><a href="day2.html"><i class="fa fa-check"></i><b>2</b> An die Daten</a>
<ul>
<li class="chapter" data-level="2.1" data-path="day2.html"><a href="day2.html#wiederholung-tag-1"><i class="fa fa-check"></i><b>2.1</b> Wiederholung Tag 1</a></li>
<li class="chapter" data-level="2.2" data-path="day2.html"><a href="day2.html#workflow-einer-datenauswertung"><i class="fa fa-check"></i><b>2.2</b> Workflow einer Datenauswertung</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="day2.html"><a href="day2.html#communication"><i class="fa fa-check"></i><b>2.2.1</b> Communication!</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="day2.html"><a href="day2.html#daten-einlesen"><i class="fa fa-check"></i><b>2.3</b> Daten einlesen</a></li>
<li class="chapter" data-level="2.4" data-path="day2.html"><a href="day2.html#the-pipe-and-dplyr-verbs"><i class="fa fa-check"></i><b>2.4</b> The pipe and dplyr verbs</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="day2.html"><a href="day2.html#select"><i class="fa fa-check"></i><b>2.4.1</b> select</a></li>
<li class="chapter" data-level="2.4.2" data-path="day2.html"><a href="day2.html#filter"><i class="fa fa-check"></i><b>2.4.2</b> filter</a></li>
<li class="chapter" data-level="2.4.3" data-path="day2.html"><a href="day2.html#mutate"><i class="fa fa-check"></i><b>2.4.3</b> mutate</a></li>
<li class="chapter" data-level="2.4.4" data-path="day2.html"><a href="day2.html#arrange"><i class="fa fa-check"></i><b>2.4.4</b> arrange</a></li>
<li class="chapter" data-level="2.4.5" data-path="day2.html"><a href="day2.html#count"><i class="fa fa-check"></i><b>2.4.5</b> count</a></li>
<li class="chapter" data-level="2.4.6" data-path="day2.html"><a href="day2.html#summarise"><i class="fa fa-check"></i><b>2.4.6</b> summarise</a></li>
<li class="chapter" data-level="2.4.7" data-path="day2.html"><a href="day2.html#group_by-und-summarise"><i class="fa fa-check"></i><b>2.4.7</b> group_by und summarise</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="day2.html"><a href="day2.html#was-ist-wahrscheinlichkeit"><i class="fa fa-check"></i><b>2.5</b> Was ist Wahrscheinlichkeit?</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="day2.html"><a href="day2.html#beispiel"><i class="fa fa-check"></i><b>2.5.1</b> Beispiel:</a></li>
<li class="chapter" data-level="2.5.2" data-path="day2.html"><a href="day2.html#p-values"><i class="fa fa-check"></i><b>2.5.2</b> P-Values</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="day2.html"><a href="day2.html#transfer-auf-neue-daten"><i class="fa fa-check"></i><b>2.6</b> Transfer auf neue Daten</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="day2.html"><a href="day2.html#übung"><i class="fa fa-check"></i><b>2.6.1</b> Übung</a></li>
<li class="chapter" data-level="2.6.2" data-path="day2.html"><a href="day2.html#lösungen"><i class="fa fa-check"></i><b>2.6.2</b> Lösungen</a></li>
<li class="chapter" data-level="2.6.3" data-path="day2.html"><a href="day2.html#bonus"><i class="fa fa-check"></i><b>2.6.3</b> Bonus</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="day3.html"><a href="day3.html"><i class="fa fa-check"></i><b>3</b> Tidy Data, Visualisierung und Statistische Größen</a>
<ul>
<li class="chapter" data-level="3.1" data-path="day3.html"><a href="day3.html#wiederholung-tag-2"><i class="fa fa-check"></i><b>3.1</b> Wiederholung Tag 2</a></li>
<li class="chapter" data-level="3.2" data-path="day3.html"><a href="day3.html#visualisierung-als-schlüssel-zum-verständnis"><i class="fa fa-check"></i><b>3.2</b> Visualisierung als Schlüssel zum Verständnis</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="day3.html"><a href="day3.html#anscombes-quartet"><i class="fa fa-check"></i><b>3.2.1</b> Anscombes Quartet</a></li>
<li class="chapter" data-level="3.2.2" data-path="day3.html"><a href="day3.html#exkurs-tidy-data"><i class="fa fa-check"></i><b>3.2.2</b> Exkurs Tidy Data</a></li>
<li class="chapter" data-level="3.2.3" data-path="day3.html"><a href="day3.html#the-datasaurus-dozen"><i class="fa fa-check"></i><b>3.2.3</b> The Datasaurus Dozen</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="day2.html"><a href="day2.html#übung"><i class="fa fa-check"></i><b>3.3</b> Übung</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="day3.html"><a href="day3.html#inclusion-bodies"><i class="fa fa-check"></i><b>3.3.1</b> Inclusion Bodies</a></li>
<li class="chapter" data-level="3.3.2" data-path="day3.html"><a href="day3.html#lösung"><i class="fa fa-check"></i><b>3.3.2</b> Lösung</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="day4.html"><a href="day4.html"><i class="fa fa-check"></i><b>4</b> Statistische Tests und Power</a>
<ul>
<li class="chapter" data-level="4.1" data-path="day4.html"><a href="day4.html#lösung-für-tag-3"><i class="fa fa-check"></i><b>4.1</b> Lösung für Tag 3</a></li>
<li class="chapter" data-level="4.2" data-path="day4.html"><a href="day4.html#der-zentrale-grenzwertsatz-clt"><i class="fa fa-check"></i><b>4.2</b> Der zentrale Grenzwertsatz (CLT)</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="day2.html"><a href="day2.html#daten-einlesen"><i class="fa fa-check"></i><b>4.2.1</b> Daten einlesen</a></li>
<li class="chapter" data-level="4.2.2" data-path="day4.html"><a href="day4.html#der-einfache-fall"><i class="fa fa-check"></i><b>4.2.2</b> Der einfache Fall</a></li>
<li class="chapter" data-level="4.2.3" data-path="day4.html"><a href="day4.html#abstraktion-für-viele-fälle"><i class="fa fa-check"></i><b>4.2.3</b> Abstraktion für viele Fälle</a></li>
<li class="chapter" data-level="4.2.4" data-path="day4.html"><a href="day4.html#exkurs-lambda-funktionen"><i class="fa fa-check"></i><b>4.2.4</b> Exkurs: Lambda-Funktionen</a></li>
<li class="chapter" data-level="4.2.5" data-path="day4.html"><a href="day4.html#populationsverteilung-vs.-verteilung-der-mittelwerte"><i class="fa fa-check"></i><b>4.2.5</b> Populationsverteilung vs. Verteilung der Mittelwerte</a></li>
<li class="chapter" data-level="4.2.6" data-path="day4.html"><a href="day4.html#exkurs-quantiles"><i class="fa fa-check"></i><b>4.2.6</b> Exkurs: Quantiles</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="day4.html"><a href="day4.html#die-t-verteilung"><i class="fa fa-check"></i><b>4.3</b> Die T-Verteilung</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="day4.html"><a href="day4.html#konfidenz-intervalle-ci"><i class="fa fa-check"></i><b>4.3.1</b> Konfidenz Intervalle (CI)</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="day4.html"><a href="day4.html#signifikanztests"><i class="fa fa-check"></i><b>4.4</b> Signifikanztests</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="day4.html"><a href="day4.html#students-t-test"><i class="fa fa-check"></i><b>4.4.1</b> Students T-Test</a></li>
<li class="chapter" data-level="4.4.2" data-path="day4.html"><a href="day4.html#wilcoxon-rank-sum-test"><i class="fa fa-check"></i><b>4.4.2</b> Wilcoxon Rank Sum Test</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="day4.html"><a href="day4.html#type-i-und-type-ii-errors"><i class="fa fa-check"></i><b>4.5</b> Type I und Type II Errors</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="day4.html"><a href="day4.html#type-i-false-positives"><i class="fa fa-check"></i><b>4.5.1</b> Type I: False Positives</a></li>
<li class="chapter" data-level="4.5.2" data-path="day4.html"><a href="day4.html#type-ii-errors"><i class="fa fa-check"></i><b>4.5.2</b> Type II errors</a></li>
<li class="chapter" data-level="4.5.3" data-path="day4.html"><a href="day4.html#statistical-power"><i class="fa fa-check"></i><b>4.5.3</b> Statistical Power</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="day4.html"><a href="day4.html#probleme"><i class="fa fa-check"></i><b>4.6</b> Probleme</a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="day4.html"><a href="day4.html#the-jelly-bean-problem-multiple-testing"><i class="fa fa-check"></i><b>4.6.1</b> The Jelly Bean Problem (Multiple Testing)</a></li>
<li class="chapter" data-level="4.6.2" data-path="day4.html"><a href="day4.html#the-base-rate-fallacy"><i class="fa fa-check"></i><b>4.6.2</b> The Base Rate Fallacy</a></li>
<li class="chapter" data-level="4.6.3" data-path="index.html"><a href="index.html#resourcen"><i class="fa fa-check"></i><b>4.6.3</b> Resourcen</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="day4.html"><a href="day4.html#übungen"><i class="fa fa-check"></i><b>4.7</b> Übungen</a>
<ul>
<li class="chapter" data-level="4.7.1" data-path="day4.html"><a href="day4.html#zeige-die-folgenden-statements-anhand-von-simulationen-in-r"><i class="fa fa-check"></i><b>4.7.1</b> Zeige die folgenden Statements anhand von Simulationen in R</a></li>
<li class="chapter" data-level="4.7.2" data-path="day4.html"><a href="day4.html#veranschauliche-die-folgenden-konzepte-anhand-von-simulationen-auf-den-vorliegenden-daten"><i class="fa fa-check"></i><b>4.7.2</b> Veranschauliche die folgenden Konzepte anhand von Simulationen auf den vorliegenden Daten</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="day5.html"><a href="day5.html"><i class="fa fa-check"></i><b>5</b> Korrelation und Regression</a>
<ul>
<li class="chapter" data-level="5.1" data-path="day5.html"><a href="day5.html#lösung-tag-4"><i class="fa fa-check"></i><b>5.1</b> Lösung Tag 4</a></li>
<li class="chapter" data-level="5.2" data-path="day5.html"><a href="day5.html#korrelation-und-regression"><i class="fa fa-check"></i><b>5.2</b> Korrelation und Regression</a></li>
<li class="chapter" data-level="5.3" data-path="day5.html"><a href="day5.html#tricks-für-viele-daten-dateien"><i class="fa fa-check"></i><b>5.3</b> Tricks für viele Daten / Dateien</a></li>
<li class="chapter" data-level="5.4" data-path="day5.html"><a href="day5.html#non-linear-regression"><i class="fa fa-check"></i><b>5.4</b> Non-Linear Regression</a></li>
<li class="chapter" data-level="5.5" data-path="day2.html"><a href="day2.html#übung"><i class="fa fa-check"></i><b>5.5</b> Übung</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="day5.html"><a href="day5.html#mit-den-datasaurus-dozen-datensets"><i class="fa fa-check"></i><b>5.5.1</b> Mit den Datasaurus Dozen Datensets</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="day6.html"><a href="day6.html"><i class="fa fa-check"></i><b>6</b> Folgt</a>
<ul>
<li class="chapter" data-level="6.1" data-path="day6.html"><a href="day6.html#lösung-tag-5"><i class="fa fa-check"></i><b>6.1</b> Lösung Tag 5</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="day5.html"><a href="day5.html#mit-den-datasaurus-dozen-datensets"><i class="fa fa-check"></i><b>6.1.1</b> Mit den Datasaurus Dozen Datensets</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="day6.html"><a href="day6.html#datenanalyse-beispiel-global-plastic-waste"><i class="fa fa-check"></i><b>6.2</b> Datenanalyse, Beispiel: Global Plastic Waste</a></li>
<li class="chapter" data-level="6.3" data-path="day6.html"><a href="day6.html#feedbackrunde"><i class="fa fa-check"></i><b>6.3</b> Feedbackrunde</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Einführung in die Datenauswertung mit R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="day4" class="section level1" number="4">
<h1><span class="header-section-number">Tag 4</span> Statistische Tests und Power</h1>
<div id="lösung-für-tag-3" class="section level2" number="4.1">
<h2><span class="header-section-number">4.1</span> Lösung für Tag 3</h2>
<ul>
<li><a href="/misc/dataIntro19_day03/analysis.rmd">Ausgangsdokument</a></li>
<li><a href="/misc/dataIntro19_day03/analysis.html">Ergebnis als html Dokument</a></li>
<li><a href="/misc/dataIntro19_day03/analysis.pdf">Ergebnis als pdf Dokument</a></li>
</ul>
</div>
<div id="der-zentrale-grenzwertsatz-clt" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Der zentrale Grenzwertsatz (CLT)</h2>
<p>Von Verteilungen zu Verteilungen von Mittelwerten</p>
<p>Was wäre, wenn Johanna als Master Studentin nicht ganz
so fleißig gewesen wäre, und statt 300 je Zell Typ nur
je 30 mal gezählt hätte?</p>
<p>Der Einfachheit nehmen wir an, dass die 300 Zellen
komplett repräsentativ für alle WT bzw. KO Zellen sind,
also die Gesamtpopulation darstellen.</p>
<ul>
<li>Nun ziehen wir zufällig daraus je 30 Zellen.</li>
<li>Das machen wir nun 1000 mal.</li>
<li>Wie sieht nun die Verteilung der Mittelwerte aus?</li>
</ul>
<div id="daten-einlesen" class="section level3" number="4.2.1">
<h3><span class="header-section-number">4.2.1</span> Daten einlesen</h3>
<p>Zunächst laden wir das Tidyverse und unsere Daten:</p>
<div class="sourceCode" id="cb168"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb168-1"><a href="day4.html#cb168-1" aria-hidden="true" tabindex="-1"></a><span class="co"># load tidyverse</span></span>
<span id="cb168-2"><a href="day4.html#cb168-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb168-3"><a href="day4.html#cb168-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-4"><a href="day4.html#cb168-4" aria-hidden="true" tabindex="-1"></a><span class="co"># import data</span></span>
<span id="cb168-5"><a href="day4.html#cb168-5" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;data/03_inclusion_bodies.csv&quot;</span>)</span>
<span id="cb168-6"><a href="day4.html#cb168-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-7"><a href="day4.html#cb168-7" aria-hidden="true" tabindex="-1"></a><span class="co"># attach data, handle with CARE!</span></span>
<span id="cb168-8"><a href="day4.html#cb168-8" aria-hidden="true" tabindex="-1"></a><span class="fu">attach</span>(data)</span></code></pre></div>
<p><code>attach</code> macht die Spalten des Datensets (in unserem Fall <em>ko</em> and <em>wt</em>)
global verfügbar. Daher können wir im Folgenden
<code>wt</code> statt <code>data$wt</code> oder <code>data["wt"]</code> schreiben.</p>
<blockquote>
<p>Verwende <code>attach</code> mit Vorsicht! Denn die Reihenfolge der beiden
Vektoren ist nun unabhängig voneinander. Operationen,
die Du mit den Vektoren <code>wt</code> und <code>ko</code> ausführst, beeinflussen
nicht den jeweils anderen Vektor oder den zugrundeliegenden
Data.frame <code>data</code>.</p>
</blockquote>
</div>
<div id="der-einfache-fall" class="section level3" number="4.2.2">
<h3><span class="header-section-number">4.2.2</span> Der einfache Fall</h3>
<p>Für den einfachen Fall ziehen wir 30 Punkte aus einem der beiden Vektoren
und berechnen den Mittelwert.</p>
<div class="sourceCode" id="cb169"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb169-1"><a href="day4.html#cb169-1" aria-hidden="true" tabindex="-1"></a><span class="co"># sample n = 30 points from a vector</span></span>
<span id="cb169-2"><a href="day4.html#cb169-2" aria-hidden="true" tabindex="-1"></a>subset <span class="ot">&lt;-</span> <span class="fu">sample</span>(wt, <span class="dv">30</span>)</span>
<span id="cb169-3"><a href="day4.html#cb169-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-4"><a href="day4.html#cb169-4" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate mean</span></span>
<span id="cb169-5"><a href="day4.html#cb169-5" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(subset)</span></code></pre></div>
<pre><code>## [1] 2.133333</code></pre>
</div>
<div id="abstraktion-für-viele-fälle" class="section level3" number="4.2.3">
<h3><span class="header-section-number">4.2.3</span> Abstraktion für viele Fälle</h3>
<p>Da wir diese Zeilen nicht 1000 mal tippen wollen schreiben wir eine Funktion,
die genau das tut. Sie nimmt einen Vektor (<code>x</code>) und zieht <code>n</code> Punkte daraus.</p>
<div class="sourceCode" id="cb171"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb171-1"><a href="day4.html#cb171-1" aria-hidden="true" tabindex="-1"></a>get_subset_mean <span class="ot">&lt;-</span> <span class="cf">function</span>(n, x) {</span>
<span id="cb171-2"><a href="day4.html#cb171-2" aria-hidden="true" tabindex="-1"></a>  subset <span class="ot">&lt;-</span> <span class="fu">sample</span>(x, n)</span>
<span id="cb171-3"><a href="day4.html#cb171-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mean</span>(subset)</span>
<span id="cb171-4"><a href="day4.html#cb171-4" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Die Funktion funktioniert:</p>
<div class="sourceCode" id="cb172"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb172-1"><a href="day4.html#cb172-1" aria-hidden="true" tabindex="-1"></a><span class="fu">get_subset_mean</span>(<span class="dv">2</span>, wt)</span></code></pre></div>
<pre><code>## [1] 6</code></pre>
<p>Mit der <code>map</code> Funktion aus dem <code>purrr</code>-Package rufen wir diese
Funktion nun 1000 mal auf uns speichern das Ergebnis in einem
Vektor, bestehend aus Kommazahlen (daher <code>map_dbl</code> für
map <em>double</em>).</p>
<div class="sourceCode" id="cb174"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb174-1"><a href="day4.html#cb174-1" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb174-2"><a href="day4.html#cb174-2" aria-hidden="true" tabindex="-1"></a>Ms <span class="ot">&lt;-</span> <span class="fu">map_dbl</span>(<span class="dv">1</span><span class="sc">:</span>N, <span class="sc">~</span> <span class="fu">get_subset_mean</span>(<span class="dv">30</span>, wt) )</span></code></pre></div>
</div>
<div id="exkurs-lambda-funktionen" class="section level3" number="4.2.4">
<h3><span class="header-section-number">4.2.4</span> Exkurs: Lambda-Funktionen</h3>
<p>Das <code>~</code>-Symbol (Tilde) erstellt eine sogenannte <em>lambda</em> Funktion, also
eine Funktion, der wir keinen Namen geben, da wir sie nur einmal
brauchen. Im Kontext der Familie von <code>map</code> Funktionen wird <code>~</code>
übersetzt:</p>
<p><code>add_one &lt;- function(x) x + 1</code>
Ist equivalent zu
<code>~ .x + 1</code>.
Hierbei heißt das Argument der Funktion immer <code>.x</code>.</p>
<p>Die
lambda Funktion <code>~ get_subset_mean(30, wt)</code> nimmt nacheinander
die Zahlen in <code>1:N</code> als Eingabe, nennt sie <code>.x</code>, aber verwendet
das Argument <code>.x</code> überhaubt nicht. In unserem Fall bedeutet das also,
dass die Funktion <code>get_subset_mean</code>
bloß 1000 mal aufgerufen wird mit den Argumenten <code>30</code> und <code>wt</code>.</p>
</div>
<div id="populationsverteilung-vs.-verteilung-der-mittelwerte" class="section level3" number="4.2.5">
<h3><span class="header-section-number">4.2.5</span> Populationsverteilung vs. Verteilung der Mittelwerte</h3>
<p>Mit großem n wird die Verteilung der Mittelwerte symmetrisch,
obwohl die Populationsverteilung unsymmetrisch ist.</p>
<div class="sourceCode" id="cb175"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb175-1"><a href="day4.html#cb175-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(Ms)</span></code></pre></div>
<p><img src="dataIntro19_files/figure-html/unnamed-chunk-118-1.svg" width="672" /></p>
<div class="sourceCode" id="cb176"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb176-1"><a href="day4.html#cb176-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(wt)</span></code></pre></div>
<p><img src="dataIntro19_files/figure-html/unnamed-chunk-119-1.svg" width="672" /></p>
<p>Nach dem Central Limit Theorem folgen die Mittelwerte
einer Normalverteilung. Dies lässt sich zeigen:</p>
<div class="sourceCode" id="cb177"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb177-1"><a href="day4.html#cb177-1" aria-hidden="true" tabindex="-1"></a><span class="co"># show qqnorm of Ms</span></span>
<span id="cb177-2"><a href="day4.html#cb177-2" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(Ms)</span>
<span id="cb177-3"><a href="day4.html#cb177-3" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(Ms, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="dataIntro19_files/figure-html/unnamed-chunk-120-1.svg" width="672" /></p>
</div>
<div id="exkurs-quantiles" class="section level3" number="4.2.6">
<h3><span class="header-section-number">4.2.6</span> Exkurs: Quantiles</h3>
<p>Am Beispiel einer Normalverteilung zeigt
<code>dnorm</code> die Wahrscheinlichkeitsdichteverteilung
(Im Englischen <em>Probability Density Function, PDF</em>).</p>
<div class="sourceCode" id="cb178"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb178-1"><a href="day4.html#cb178-1" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(dnorm, <span class="sc">-</span><span class="dv">3</span>, <span class="dv">3</span>)</span></code></pre></div>
<div class="figure"><span id="fig:dnorm1"></span>
<img src="dataIntro19_files/figure-html/dnorm1-1.svg" alt="Die Wahrscheinlichkeit, einen Wert zwischen z.B. -1 und 1 zu ziehen, entspricht dem Integral der Funktion in diesem Bereich." width="672" />
<p class="caption">
Abb. 4.1: Die Wahrscheinlichkeit, einen Wert zwischen z.B. -1 und 1 zu ziehen, entspricht dem Integral der Funktion in diesem Bereich.
</p>
</div>
<p>Wenn wir nun das Integral von <span class="math inline">\(-\infty\)</span> bis <span class="math inline">\(x\)</span> berechnen erhalten wir
die kumulative Wahrscheinlichkeitsfunktion <code>pnorm</code>.</p>
<div class="sourceCode" id="cb179"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb179-1"><a href="day4.html#cb179-1" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(pnorm, <span class="sc">-</span><span class="dv">3</span>, <span class="dv">3</span>)</span></code></pre></div>
<div class="figure"><span id="fig:pnorm1"></span>
<img src="dataIntro19_files/figure-html/pnorm1-1.svg" alt="pnorm von x ist also die Wahrscheinlichkeit, einen Wert kleiner oder gleich x aus dnorm zu ziehen." width="672" />
<p class="caption">
Abb. 4.2: pnorm von x ist also die Wahrscheinlichkeit, einen Wert kleiner oder gleich x aus dnorm zu ziehen.
</p>
</div>
<p><code>qnomr</code>, die Quantil-Funktion,
ist nun die Inverse dieser Funkion, hat also die Achsen vertauscht.</p>
<div class="sourceCode" id="cb180"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb180-1"><a href="day4.html#cb180-1" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(qnorm, <span class="dv">0</span>, <span class="dv">1</span>)</span></code></pre></div>
<p><img src="dataIntro19_files/figure-html/unnamed-chunk-121-1.svg" width="672" /></p>
</div>
</div>
<div id="die-t-verteilung" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> Die T-Verteilung</h2>
<p>Der zentrale Grenzwertsatz gilt erst bei großen <em>sample sizes</em>.
Darunter ist die Verteilung der Mittelwerte an den Rändern
dicker, als eine Normalverteilung.</p>
<p>Daher verwenden wir (sicherheitshalber) für
die meisten Daten und statistischen Tests die T-Verteilung,
nicht die Normalverteilung.</p>
<p>Für 3 Freiheitsgrade:</p>
<div class="sourceCode" id="cb181"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb181-1"><a href="day4.html#cb181-1" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(dnorm, <span class="sc">-</span><span class="dv">3</span>, <span class="dv">3</span>)</span>
<span id="cb181-2"><a href="day4.html#cb181-2" aria-hidden="true" tabindex="-1"></a>tdist <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="fu">dt</span>(x, <span class="at">df =</span> <span class="dv">3</span>)</span>
<span id="cb181-3"><a href="day4.html#cb181-3" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(tdist, <span class="sc">-</span><span class="dv">3</span>, <span class="dv">3</span>, <span class="at">add =</span> <span class="cn">TRUE</span>, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<div class="figure"><span id="fig:tdist"></span>
<img src="dataIntro19_files/figure-html/tdist-1.svg" alt="T-Verteilung in Rot" width="672" />
<p class="caption">
Abb. 4.3: T-Verteilung in Rot
</p>
</div>
<p>Für 30 Freiheitsgrade</p>
<div class="sourceCode" id="cb182"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb182-1"><a href="day4.html#cb182-1" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(dnorm, <span class="sc">-</span><span class="dv">3</span>, <span class="dv">3</span>)</span>
<span id="cb182-2"><a href="day4.html#cb182-2" aria-hidden="true" tabindex="-1"></a>tdist <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="fu">dt</span>(x, <span class="at">df =</span> <span class="dv">30</span>)</span>
<span id="cb182-3"><a href="day4.html#cb182-3" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(tdist, <span class="sc">-</span><span class="dv">3</span>, <span class="dv">3</span>, <span class="at">add =</span> <span class="cn">TRUE</span>, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="dataIntro19_files/figure-html/unnamed-chunk-122-1.svg" width="672" /></p>
<div id="konfidenz-intervalle-ci" class="section level3" number="4.3.1">
<h3><span class="header-section-number">4.3.1</span> Konfidenz Intervalle (CI)</h3>
<p>Gleichermaßen können wir mit der t-Verteilung
95% Konfidenzintervalle berechnen.</p>
<p>Das 95% Konfidenzintervall eines Sample-Mittelwerts
umschließt den wahren Mittelwert (den Mittelwert der Gesamtpopulation)
in 95% der Fälle (wenn Du das Experiment unendlich oft wiederholen würdest).</p>
<div class="sourceCode" id="cb183"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb183-1"><a href="day4.html#cb183-1" aria-hidden="true" tabindex="-1"></a><span class="co"># show hist of Ms</span></span>
<span id="cb183-2"><a href="day4.html#cb183-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(Ms)</span>
<span id="cb183-3"><a href="day4.html#cb183-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb183-4"><a href="day4.html#cb183-4" aria-hidden="true" tabindex="-1"></a><span class="co"># add line for true mean of wt</span></span>
<span id="cb183-5"><a href="day4.html#cb183-5" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> <span class="fu">mean</span>(wt), <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">lwd =</span> <span class="dv">3</span>)</span></code></pre></div>
<div class="figure"><span id="fig:ci-vis"></span>
<img src="dataIntro19_files/figure-html/ci-vis-1.svg" alt="Wahrer Mittelwert in Rot" width="672" />
<p class="caption">
Abb. 4.4: Wahrer Mittelwert in Rot
</p>
</div>
<div class="sourceCode" id="cb184"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb184-1"><a href="day4.html#cb184-1" aria-hidden="true" tabindex="-1"></a><span class="co"># use t.test for conf.int</span></span>
<span id="cb184-2"><a href="day4.html#cb184-2" aria-hidden="true" tabindex="-1"></a>subset <span class="ot">&lt;-</span> <span class="fu">sample</span>(wt, <span class="dv">30</span>)</span>
<span id="cb184-3"><a href="day4.html#cb184-3" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(subset)</span></code></pre></div>
<pre><code>## [1] 3.166667</code></pre>
<div class="sourceCode" id="cb186"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb186-1"><a href="day4.html#cb186-1" aria-hidden="true" tabindex="-1"></a>lims <span class="ot">&lt;-</span> <span class="fu">t.test</span>(subset)<span class="sc">$</span>conf.int</span>
<span id="cb186-2"><a href="day4.html#cb186-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb186-3"><a href="day4.html#cb186-3" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(subset, <span class="at">breaks =</span> <span class="dv">20</span>)</span>
<span id="cb186-4"><a href="day4.html#cb186-4" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> lims[<span class="dv">1</span>], <span class="at">col =</span> <span class="st">&quot;red&quot;</span>)</span>
<span id="cb186-5"><a href="day4.html#cb186-5" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> lims[<span class="dv">2</span>], <span class="at">col =</span> <span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="dataIntro19_files/figure-html/unnamed-chunk-123-1.svg" width="672" /></p>
</div>
</div>
<div id="signifikanztests" class="section level2" number="4.4">
<h2><span class="header-section-number">4.4</span> Signifikanztests</h2>
<p>Signifikanztests beantworten die Frage:</p>
<blockquote>
<p>Unter der Annahme, dass es zwischen zwei (oder mehr)
Gruppen keinen Unterschied gibt (also sie aus der gleichen
Verteilung stammen), wie wahrscheinlich ist es dann,
einen so großen, oder größeren, Unterschied, wie beobachtet,
zu finden?</p>
</blockquote>
<div id="students-t-test" class="section level3" number="4.4.1">
<h3><span class="header-section-number">4.4.1</span> Students T-Test</h3>
<p>Für normalverteilte Daten verwenden wir den Students T-Test.</p>
<p><img src="dataIntro19_files/figure-html/unnamed-chunk-124-1.svg" width="672" /></p>
<div class="sourceCode" id="cb187"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb187-1"><a href="day4.html#cb187-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(wt, ko)</span></code></pre></div>
<pre><code>## 
## 	Welch Two Sample t-test
## 
## data:  wt and ko
## t = -26.929, df = 476.21, p-value &lt; 2.2e-16
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  -13.19393 -11.39940
## sample estimates:
## mean of x mean of y 
##  3.043333 15.340000</code></pre>
<div class="sourceCode" id="cb189"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb189-1"><a href="day4.html#cb189-1" aria-hidden="true" tabindex="-1"></a>subset_wt <span class="ot">&lt;-</span> <span class="fu">sample</span>(wt, <span class="dv">3</span>)</span>
<span id="cb189-2"><a href="day4.html#cb189-2" aria-hidden="true" tabindex="-1"></a>subset_ko <span class="ot">&lt;-</span> <span class="fu">sample</span>(ko, <span class="dv">3</span>)</span>
<span id="cb189-3"><a href="day4.html#cb189-3" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(subset_wt, subset_ko)</span></code></pre></div>
<pre><code>## 
## 	Welch Two Sample t-test
## 
## data:  subset_wt and subset_ko
## t = -6.8224, df = 2.6162, p-value = 0.009833
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  -16.081856  -5.251477
## sample estimates:
## mean of x mean of y 
##   1.00000  11.66667</code></pre>
</div>
<div id="wilcoxon-rank-sum-test" class="section level3" number="4.4.2">
<h3><span class="header-section-number">4.4.2</span> Wilcoxon Rank Sum Test</h3>
<p>Sind unsere Daten nicht normalverteilt,
wie es hier der Fall ist, ist ein sogenannter
nicht-parametrischer Test angebracht. Diese Tests
machen nicht die Annahme der Normalität.</p>
<p>Der Wilcoxon Rank Sum Test (Auch Mann-Whitney U Test genannt)
wandelt die eigentlichen Werte der Datenpunkte zunächst
in Ränge um. Also:</p>
<blockquote>
<p>“Der wievieltniedrigste Punkt ist es?”</p>
</blockquote>
<p>Beispiel:</p>
<div class="sourceCode" id="cb191"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb191-1"><a href="day4.html#cb191-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">20</span>, <span class="dv">1239132</span>, <span class="dv">3</span>, <span class="dv">5</span>)</span>
<span id="cb191-2"><a href="day4.html#cb191-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rank</span>(x)</span></code></pre></div>
<pre><code>## [1] 1 2 5 6 3 4</code></pre>
<p>Und an unseren Daten:</p>
<p><img src="dataIntro19_files/figure-html/unnamed-chunk-128-1.svg" width="672" /></p>
<div class="sourceCode" id="cb193"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb193-1"><a href="day4.html#cb193-1" aria-hidden="true" tabindex="-1"></a><span class="fu">wilcox.test</span>(wt, ko)</span></code></pre></div>
<pre><code>## 
## 	Wilcoxon rank sum test with continuity
## 	correction
## 
## data:  wt and ko
## W = 4707.5, p-value &lt; 2.2e-16
## alternative hypothesis: true location shift is not equal to 0</code></pre>
</div>
</div>
<div id="type-i-und-type-ii-errors" class="section level2" number="4.5">
<h2><span class="header-section-number">4.5</span> Type I und Type II Errors</h2>
<ul>
<li>Type I: False Positives (rejection of a true null hypothesis)</li>
<li>Type II: False Negatives (non-rejection of false null hypothesis)</li>
</ul>
<div id="type-i-false-positives" class="section level3" number="4.5.1">
<h3><span class="header-section-number">4.5.1</span> Type I: False Positives</h3>
<p>Ein Typ I Fehler würde bedeuten, dass wir sagen, ein Unterschied
zwischen den Gruppen existiere,
obwohl alle Werte aus der gleichen Verteilung stammen und daher kein
Unterschied besteht.</p>
<p>Bei einem P-Value von <span class="math inline">\(\leq\)</span> 0.05 (= 5 %) wird typischerweise
gesagt, dass ein “statistisch signifikanter” Unterschied besteht.
Mit diesem typischen Cutoff von 0.05 akzeptieren
wir also, allein durch unsere Definition, bereits (mindestens)
5 % falsch Positive.</p>
<p>Dieser Cutoff, das Signifikanzlevel, wird auch <span class="math inline">\(\alpha\)</span> genannt.</p>
<p><span class="math display">\[\alpha=\text{Type I error rate}\]</span></p>
<div class="sourceCode" id="cb195"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb195-1"><a href="day4.html#cb195-1" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(dnorm, <span class="sc">-</span><span class="dv">3</span> , <span class="dv">3</span>)</span></code></pre></div>
<p><img src="dataIntro19_files/figure-html/unnamed-chunk-130-1.svg" width="672" /></p>
<div class="sourceCode" id="cb196"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb196-1"><a href="day4.html#cb196-1" aria-hidden="true" tabindex="-1"></a><span class="co"># define n</span></span>
<span id="cb196-2"><a href="day4.html#cb196-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb196-3"><a href="day4.html#cb196-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-4"><a href="day4.html#cb196-4" aria-hidden="true" tabindex="-1"></a><span class="co"># draw twice from the same normal distributions</span></span>
<span id="cb196-5"><a href="day4.html#cb196-5" aria-hidden="true" tabindex="-1"></a>draw1 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n)</span>
<span id="cb196-6"><a href="day4.html#cb196-6" aria-hidden="true" tabindex="-1"></a>draw2 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n)</span>
<span id="cb196-7"><a href="day4.html#cb196-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-8"><a href="day4.html#cb196-8" aria-hidden="true" tabindex="-1"></a><span class="co"># do the t.test</span></span>
<span id="cb196-9"><a href="day4.html#cb196-9" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(draw1, draw2)</span></code></pre></div>
<pre><code>## 
## 	Welch Two Sample t-test
## 
## data:  draw1 and draw2
## t = -0.31189, df = 3.0148, p-value = 0.7754
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  -3.651341  2.997886
## sample estimates:
##  mean of x  mean of y 
## -0.1263381  0.2003894</code></pre>
<div class="sourceCode" id="cb198"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb198-1"><a href="day4.html#cb198-1" aria-hidden="true" tabindex="-1"></a><span class="co"># do the rank sum test</span></span>
<span id="cb198-2"><a href="day4.html#cb198-2" aria-hidden="true" tabindex="-1"></a><span class="fu">wilcox.test</span>(draw1,  draw2)</span></code></pre></div>
<pre><code>## 
## 	Wilcoxon rank sum exact test
## 
## data:  draw1 and draw2
## W = 4, p-value = 1
## alternative hypothesis: true location shift is not equal to 0</code></pre>
<p>Teste diesen Code mit unterschiedlichen Werten für <code>n</code>.</p>
</div>
<div id="type-ii-errors" class="section level3" number="4.5.2">
<h3><span class="header-section-number">4.5.2</span> Type II errors</h3>
<p>Wenn zwischen zwei Gruppen ein tatsächlicher Unterschied besteht,
wir aber bei unserem Test ein nicht signifikantes Ergebnis erhalten,
begehen wir einen Fehler vom Typ II.</p>
<p>Ein Typ II Fehler ist also ein falsch negatives Ergebnis.</p>
<p><span class="math display">\[\beta=\text{Type II error rate}\]</span></p>
<div class="sourceCode" id="cb200"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb200-1"><a href="day4.html#cb200-1" aria-hidden="true" tabindex="-1"></a><span class="co"># define n</span></span>
<span id="cb200-2"><a href="day4.html#cb200-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">15</span></span>
<span id="cb200-3"><a href="day4.html#cb200-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-4"><a href="day4.html#cb200-4" aria-hidden="true" tabindex="-1"></a><span class="co"># draw from different normal distributions</span></span>
<span id="cb200-5"><a href="day4.html#cb200-5" aria-hidden="true" tabindex="-1"></a>draw1 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb200-6"><a href="day4.html#cb200-6" aria-hidden="true" tabindex="-1"></a>draw2 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb200-7"><a href="day4.html#cb200-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-8"><a href="day4.html#cb200-8" aria-hidden="true" tabindex="-1"></a><span class="co"># convert to tibble, pivot_longer, plot points</span></span>
<span id="cb200-9"><a href="day4.html#cb200-9" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(draw1, draw2) <span class="sc">%&gt;%</span> </span>
<span id="cb200-10"><a href="day4.html#cb200-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb200-11"><a href="day4.html#cb200-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(name, value, <span class="at">group =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb200-12"><a href="day4.html#cb200-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">width =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb200-13"><a href="day4.html#cb200-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">geom =</span> <span class="st">&quot;line&quot;</span>, <span class="at">fun.y =</span> mean, <span class="at">lwd =</span> <span class="dv">1</span>, <span class="at">lty =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb200-14"><a href="day4.html#cb200-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">geom =</span> <span class="st">&quot;point&quot;</span>, <span class="at">fun.y =</span> mean, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>, <span class="at">size =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="dataIntro19_files/figure-html/unnamed-chunk-132-1.svg" width="672" /></p>
<div class="sourceCode" id="cb201"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb201-1"><a href="day4.html#cb201-1" aria-hidden="true" tabindex="-1"></a><span class="co"># do the t.test</span></span>
<span id="cb201-2"><a href="day4.html#cb201-2" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(draw1, draw2)</span></code></pre></div>
<pre><code>## 
## 	Welch Two Sample t-test
## 
## data:  draw1 and draw2
## t = -2.5888, df = 27.319, p-value = 0.01525
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  -1.9133144 -0.2219188
## sample estimates:
##  mean of x  mean of y 
## 0.06255136 1.13016800</code></pre>
<div class="sourceCode" id="cb203"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb203-1"><a href="day4.html#cb203-1" aria-hidden="true" tabindex="-1"></a><span class="co"># do the rank sum test</span></span>
<span id="cb203-2"><a href="day4.html#cb203-2" aria-hidden="true" tabindex="-1"></a><span class="fu">wilcox.test</span>(draw1,  draw2)</span></code></pre></div>
<pre><code>## 
## 	Wilcoxon rank sum exact test
## 
## data:  draw1 and draw2
## W = 57, p-value = 0.0209
## alternative hypothesis: true location shift is not equal to 0</code></pre>
</div>
<div id="statistical-power" class="section level3" number="4.5.3">
<h3><span class="header-section-number">4.5.3</span> Statistical Power</h3>
<p>Als statistische Power bezeichnen wir die Wahrscheinlichkeit eines Tests, einen wahren Unterschied
zwischen Gruppen bei dem gewählten <span class="math inline">\(\alpha\)</span> auch tatsächlich als statistisch signifikant zu kennzeichnen
und damit ein wahr positives Ergebnis zu produzieren.</p>
<p><span class="math display">\[Power = 1-\beta\]</span></p>
<p>Für den T-Test können wir in R die folgende Funktion verwenden, die uns hier beispielsweise
die Frage beantwortet: “Wie viele Proben muss ich pro Gruppe (mindestens) nehmen,
um einen erwarteten Unterschied der Mittelwerte von 1 mit einer Standardabweichung von 1
in 80% der Fälle auch tatsächlich als solchen zu erkennen?”</p>
<div class="sourceCode" id="cb205"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb205-1"><a href="day4.html#cb205-1" aria-hidden="true" tabindex="-1"></a><span class="co"># show power.t.test</span></span>
<span id="cb205-2"><a href="day4.html#cb205-2" aria-hidden="true" tabindex="-1"></a><span class="fu">power.t.test</span>(<span class="at">delta =</span> <span class="dv">1</span>, <span class="at">sd =</span> <span class="dv">1</span>, <span class="at">power =</span> <span class="fl">0.8</span>)</span></code></pre></div>
<pre><code>## 
##      Two-sample t test power calculation 
## 
##               n = 16.71477
##           delta = 1
##              sd = 1
##       sig.level = 0.05
##           power = 0.8
##     alternative = two.sided
## 
## NOTE: n is number in *each* group</code></pre>
</div>
</div>
<div id="probleme" class="section level2" number="4.6">
<h2><span class="header-section-number">4.6</span> Probleme</h2>
<div id="the-jelly-bean-problem-multiple-testing" class="section level3" number="4.6.1">
<h3><span class="header-section-number">4.6.1</span> The Jelly Bean Problem (Multiple Testing)</h3>
<p>Die False Discovery Rate (FDA) kontrollieren:</p>
<ul>
<li>Bonferroni Korrektur</li>
</ul>
<div class="sourceCode" id="cb207"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb207-1"><a href="day4.html#cb207-1" aria-hidden="true" tabindex="-1"></a><span class="co"># show p.adjust</span></span>
<span id="cb207-2"><a href="day4.html#cb207-2" aria-hidden="true" tabindex="-1"></a><span class="fu">p.adjust</span>(<span class="fu">c</span>(<span class="fl">0.05</span>, <span class="fl">0.0001</span>, <span class="fl">0.003323</span>, <span class="fl">0.7</span>), <span class="at">method =</span> <span class="st">&quot;bonferroni&quot;</span>)</span></code></pre></div>
<pre><code>## [1] 0.200000 0.000400 0.013292 1.000000</code></pre>
<p>Jeder P-Value wird mutipliziert mit der Zahl der Tests</p>
<ul>
<li>Benjamini-Hochberg Prozedur
<ul>
<li>Ordne alle p-values in aufsteigender Reihenfolge</li>
<li>Wähle eine FDR (<span class="math inline">\(q\)</span>) und nenne die Anzahl deiner Tests <span class="math inline">\(m\)</span></li>
<li>Finde den größten p-value für den gilt:
<span class="math inline">\(p \leq iq/m\)</span> mit dem Index des p-values <span class="math inline">\(i\)</span>.</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb209"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb209-1"><a href="day4.html#cb209-1" aria-hidden="true" tabindex="-1"></a><span class="co"># show p.adjust for BH</span></span>
<span id="cb209-2"><a href="day4.html#cb209-2" aria-hidden="true" tabindex="-1"></a><span class="fu">p.adjust</span>(<span class="fu">c</span>(<span class="fl">0.05</span>, <span class="fl">0.0001</span>, <span class="fl">0.003323</span>, <span class="fl">0.7</span>), <span class="at">method =</span> <span class="st">&quot;BH&quot;</span>)</span></code></pre></div>
<pre><code>## [1] 0.06666667 0.00040000 0.00664600 0.70000000</code></pre>
</div>
<div id="the-base-rate-fallacy" class="section level3" number="4.6.2">
<h3><span class="header-section-number">4.6.2</span> The Base Rate Fallacy</h3>
<p>Beispiel: Mammogramm</p>
<ul>
<li>Sensitivity = Power = true positive rate</li>
<li>Specificity = true negative rate = <span class="math inline">\(1-\alpha\)</span></li>
</ul>
<div class="sourceCode" id="cb211"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb211-1"><a href="day4.html#cb211-1" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate </span></span>
<span id="cb211-2"><a href="day4.html#cb211-2" aria-hidden="true" tabindex="-1"></a>total <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb211-3"><a href="day4.html#cb211-3" aria-hidden="true" tabindex="-1"></a>positives <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb211-4"><a href="day4.html#cb211-4" aria-hidden="true" tabindex="-1"></a>negatives <span class="ot">&lt;-</span> total <span class="sc">-</span> positives</span>
<span id="cb211-5"><a href="day4.html#cb211-5" aria-hidden="true" tabindex="-1"></a>sensitivity <span class="ot">&lt;-</span> <span class="fl">0.9</span></span>
<span id="cb211-6"><a href="day4.html#cb211-6" aria-hidden="true" tabindex="-1"></a>specificity <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fl">0.08</span></span>
<span id="cb211-7"><a href="day4.html#cb211-7" aria-hidden="true" tabindex="-1"></a>true_positives  <span class="ot">&lt;-</span> sensitivity <span class="sc">*</span> positives</span>
<span id="cb211-8"><a href="day4.html#cb211-8" aria-hidden="true" tabindex="-1"></a>false_positives <span class="ot">&lt;-</span> (<span class="dv">1</span> <span class="sc">-</span> specificity) <span class="sc">*</span> negatives</span>
<span id="cb211-9"><a href="day4.html#cb211-9" aria-hidden="true" tabindex="-1"></a>p_positive <span class="ot">&lt;-</span> true_positives <span class="sc">/</span> (true_positives <span class="sc">+</span> false_positives)</span>
<span id="cb211-10"><a href="day4.html#cb211-10" aria-hidden="true" tabindex="-1"></a>p_positive</span></code></pre></div>
<pre><code>## [1] 0.1020408</code></pre>
<p><img src="dataIntro19_files/figure-html/unnamed-chunk-137-1.svg" width="672" /></p>
<p><img src="dataIntro19_files/figure-html/unnamed-chunk-138-1.svg" width="672" /></p>
<p><img src="dataIntro19_files/figure-html/unnamed-chunk-139-1.svg" width="672" /></p>
</div>
<div id="resourcen" class="section level3" number="4.6.3">
<h3><span class="header-section-number">4.6.3</span> Resourcen</h3>
<ul>
<li>Statistics Done Wrong: <a href="https://www.statisticsdonewrong.com/" class="uri">https://www.statisticsdonewrong.com/</a></li>
<li>Intuitive Biostatistics, auch in der Uni-Bib: <a href="https://katalog.ub.uni-heidelberg.de/cgi-bin/titel.cgi?katkey=68260114&amp;sess=050a1316767b181982c9bce94283e9ae&amp;query=Intuitive%20Biostatistics" class="uri">https://katalog.ub.uni-heidelberg.de/cgi-bin/titel.cgi?katkey=68260114&amp;sess=050a1316767b181982c9bce94283e9ae&amp;query=Intuitive%20Biostatistics</a></li>
<li><a href="https://www.graphpad.com/guides/prism/8/statistics/index.htm" class="uri">https://www.graphpad.com/guides/prism/8/statistics/index.htm</a></li>
</ul>
</div>
</div>
<div id="übungen" class="section level2" number="4.7">
<h2><span class="header-section-number">4.7</span> Übungen</h2>
<div id="zeige-die-folgenden-statements-anhand-von-simulationen-in-r" class="section level3" number="4.7.1">
<h3><span class="header-section-number">4.7.1</span> Zeige die folgenden Statements anhand von Simulationen in R</h3>
<div id="wenn-du-die-sample-size-n-erhöhst-verringert-sich-der-standard-error-of-the-mean-mit-der-wurzel-von-n." class="section level4" number="4.7.1.1">
<h4><span class="header-section-number">4.7.1.1</span> Wenn Du die Sample Size n erhöhst, verringert sich der Standard Error of the Mean mit der Wurzel von n.</h4>
<ul>
<li>Ziehe 10 Zellen aus dem wt (oder ko) Vektor</li>
<li>Berechne den Mittelwert</li>
<li>Wiederhole das Ganze 1000 mal</li>
<li>Berechne die SD der 1000 Mittelwerte</li>
<li>Ziehe nun 40 statt 10 Zellen und wiederhole die Schritte</li>
<li>Schreibe eine Funktion, die n Zellen zieht, die Schritte ausführt
und die SD ausgibt</li>
<li>Füttere die Zahlen von 1 bis 100 in die Funktion
(mit map_dbl) und plotte das Ergebnis</li>
</ul>
</div>
<div id="lösung" class="section level4" number="4.7.1.2">
<h4><span class="header-section-number">4.7.1.2</span> Lösung</h4>
<div class="sourceCode" id="cb213"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb213-1"><a href="day4.html#cb213-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb213-2"><a href="day4.html#cb213-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb213-3"><a href="day4.html#cb213-3" aria-hidden="true" tabindex="-1"></a><span class="fu">read_csv</span>(<span class="st">&quot;data/03_inclusion_bodies.csv&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">attach</span>()</span></code></pre></div>
<div class="sourceCode" id="cb214"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb214-1"><a href="day4.html#cb214-1" aria-hidden="true" tabindex="-1"></a>draw <span class="ot">&lt;-</span> <span class="fu">sample</span>(wt, <span class="dv">10</span>)</span>
<span id="cb214-2"><a href="day4.html#cb214-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(draw)</span></code></pre></div>
<pre><code>## [1] 3.5</code></pre>
<div class="sourceCode" id="cb216"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb216-1"><a href="day4.html#cb216-1" aria-hidden="true" tabindex="-1"></a>get_sample_mean <span class="ot">&lt;-</span> <span class="cf">function</span>(x, n) {</span>
<span id="cb216-2"><a href="day4.html#cb216-2" aria-hidden="true" tabindex="-1"></a>  draw <span class="ot">&lt;-</span> <span class="fu">sample</span>(x, n, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb216-3"><a href="day4.html#cb216-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mean</span>(draw)</span>
<span id="cb216-4"><a href="day4.html#cb216-4" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb217"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb217-1"><a href="day4.html#cb217-1" aria-hidden="true" tabindex="-1"></a><span class="fu">get_sample_mean</span>(wt, <span class="dv">10</span>)</span></code></pre></div>
<pre><code>## [1] 3.9</code></pre>
<div class="sourceCode" id="cb219"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb219-1"><a href="day4.html#cb219-1" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb219-2"><a href="day4.html#cb219-2" aria-hidden="true" tabindex="-1"></a>many_means <span class="ot">&lt;-</span> <span class="fu">map_dbl</span>(<span class="dv">1</span><span class="sc">:</span>N, <span class="sc">~</span> <span class="fu">get_sample_mean</span>(wt, <span class="dv">10</span>) )</span>
<span id="cb219-3"><a href="day4.html#cb219-3" aria-hidden="true" tabindex="-1"></a><span class="fu">sd</span>(many_means)</span></code></pre></div>
<pre><code>## [1] 1.245121</code></pre>
<div class="sourceCode" id="cb221"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb221-1"><a href="day4.html#cb221-1" aria-hidden="true" tabindex="-1"></a>many_means <span class="ot">&lt;-</span> <span class="fu">map_dbl</span>(<span class="dv">1</span><span class="sc">:</span>N, <span class="sc">~</span><span class="fu">get_sample_mean</span>(wt, <span class="dv">40</span>))</span>
<span id="cb221-2"><a href="day4.html#cb221-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sd</span>(many_means)</span></code></pre></div>
<pre><code>## [1] 0.6121342</code></pre>
<div class="sourceCode" id="cb223"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb223-1"><a href="day4.html#cb223-1" aria-hidden="true" tabindex="-1"></a><span class="co"># explain default arguments and scoping</span></span>
<span id="cb223-2"><a href="day4.html#cb223-2" aria-hidden="true" tabindex="-1"></a>get_sd_of_many_means <span class="ot">&lt;-</span> <span class="cf">function</span>(n, x, <span class="at">N =</span> <span class="dv">1000</span>) {</span>
<span id="cb223-3"><a href="day4.html#cb223-3" aria-hidden="true" tabindex="-1"></a>  many_means <span class="ot">&lt;-</span> <span class="fu">map_dbl</span>(<span class="dv">1</span><span class="sc">:</span>N, <span class="sc">~</span><span class="fu">get_sample_mean</span>(x, n))</span>
<span id="cb223-4"><a href="day4.html#cb223-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sd</span>(many_means)</span>
<span id="cb223-5"><a href="day4.html#cb223-5" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb224"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb224-1"><a href="day4.html#cb224-1" aria-hidden="true" tabindex="-1"></a>n_max <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb224-2"><a href="day4.html#cb224-2" aria-hidden="true" tabindex="-1"></a>sds_by_n <span class="ot">&lt;-</span> <span class="fu">map_dbl</span>(<span class="dv">1</span><span class="sc">:</span>n_max, get_sd_of_many_means, <span class="at">x =</span> wt)</span></code></pre></div>
<div class="sourceCode" id="cb225"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb225-1"><a href="day4.html#cb225-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x =</span> <span class="dv">1</span><span class="sc">:</span>n_max,</span>
<span id="cb225-2"><a href="day4.html#cb225-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">y =</span> sds_by_n, <span class="at">type =</span> <span class="st">&quot;p&quot;</span>)</span>
<span id="cb225-3"><a href="day4.html#cb225-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb225-4"><a href="day4.html#cb225-4" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">sd</span>(wt)<span class="sc">/</span><span class="fu">sqrt</span>(x), <span class="at">add =</span> <span class="cn">TRUE</span>, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="dataIntro19_files/figure-html/unnamed-chunk-148-1.svg" width="672" /></p>
<div class="sourceCode" id="cb226"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb226-1"><a href="day4.html#cb226-1" aria-hidden="true" tabindex="-1"></a><span class="co"># talk about difference between sample sd and population sd</span></span></code></pre></div>
</div>
<div id="ein-95-konfidenzintervall-eines-samples-enthält-den-populationsmittelwert-mit-einer-wahrscheinlichkeit-von-95." class="section level4" number="4.7.1.3">
<h4><span class="header-section-number">4.7.1.3</span> Ein 95% Konfidenzintervall eines Samples enthält den Populationsmittelwert mit einer Wahrscheinlichkeit von 95%.</h4>
<ul>
<li>Ziehe 30 Zellen aus dem wt (oder ko) Vektor</li>
<li>Berechne die Limits des CI (Confidence Interval)</li>
<li>Schreibe eine Funktion, oben genanntes tut und
führe sie 1000 mal aus.</li>
<li>Schreibe eine Funktion, die testet, ob ein Set an Limits den
wahren Mittelwert einschließt</li>
<li>Wende sie auf die 1000 Sets der Limits an</li>
<li>Wie oft (prozentual) erhältst du TRUE?</li>
</ul>
</div>
<div id="lösung-1" class="section level4" number="4.7.1.4">
<h4><span class="header-section-number">4.7.1.4</span> Lösung</h4>
<div class="sourceCode" id="cb227"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb227-1"><a href="day4.html#cb227-1" aria-hidden="true" tabindex="-1"></a>draw <span class="ot">&lt;-</span> <span class="fu">sample</span>(wt, <span class="dv">30</span>)</span></code></pre></div>
<div class="sourceCode" id="cb228"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb228-1"><a href="day4.html#cb228-1" aria-hidden="true" tabindex="-1"></a>test_results <span class="ot">&lt;-</span> <span class="fu">t.test</span>(draw)</span></code></pre></div>
<div class="sourceCode" id="cb229"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb229-1"><a href="day4.html#cb229-1" aria-hidden="true" tabindex="-1"></a>test_results</span></code></pre></div>
<pre><code>## 
## 	One Sample t-test
## 
## data:  draw
## t = 3.9747, df = 29, p-value = 0.0004285
## alternative hypothesis: true mean is not equal to 0
## 95 percent confidence interval:
##  1.165051 3.634949
## sample estimates:
## mean of x 
##       2.4</code></pre>
<div class="sourceCode" id="cb231"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb231-1"><a href="day4.html#cb231-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(test_results)</span></code></pre></div>
<pre><code>##             Length Class  Mode     
## statistic   1      -none- numeric  
## parameter   1      -none- numeric  
## p.value     1      -none- numeric  
## conf.int    2      -none- numeric  
## estimate    1      -none- numeric  
## null.value  1      -none- numeric  
## stderr      1      -none- numeric  
## alternative 1      -none- character
## method      1      -none- character
## data.name   1      -none- character</code></pre>
<div class="sourceCode" id="cb233"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb233-1"><a href="day4.html#cb233-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(test_results)</span></code></pre></div>
<pre><code>## List of 10
##  $ statistic  : Named num 3.97
##   ..- attr(*, &quot;names&quot;)= chr &quot;t&quot;
##  $ parameter  : Named num 29
##   ..- attr(*, &quot;names&quot;)= chr &quot;df&quot;
##  $ p.value    : num 0.000428
##  $ conf.int   : num [1:2] 1.17 3.63
##   ..- attr(*, &quot;conf.level&quot;)= num 0.95
##  $ estimate   : Named num 2.4
##   ..- attr(*, &quot;names&quot;)= chr &quot;mean of x&quot;
##  $ null.value : Named num 0
##   ..- attr(*, &quot;names&quot;)= chr &quot;mean&quot;
##  $ stderr     : num 0.604
##  $ alternative: chr &quot;two.sided&quot;
##  $ method     : chr &quot;One Sample t-test&quot;
##  $ data.name  : chr &quot;draw&quot;
##  - attr(*, &quot;class&quot;)= chr &quot;htest&quot;</code></pre>
<div class="sourceCode" id="cb235"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb235-1"><a href="day4.html#cb235-1" aria-hidden="true" tabindex="-1"></a>test_results<span class="sc">$</span>conf.int</span></code></pre></div>
<pre><code>## [1] 1.165051 3.634949
## attr(,&quot;conf.level&quot;)
## [1] 0.95</code></pre>
<div class="sourceCode" id="cb237"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb237-1"><a href="day4.html#cb237-1" aria-hidden="true" tabindex="-1"></a>get_sample_ci <span class="ot">&lt;-</span> <span class="cf">function</span>(x, n) {</span>
<span id="cb237-2"><a href="day4.html#cb237-2" aria-hidden="true" tabindex="-1"></a>  draw <span class="ot">&lt;-</span> <span class="fu">sample</span>(x, n, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb237-3"><a href="day4.html#cb237-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">t.test</span>(draw)<span class="sc">$</span>conf.int</span>
<span id="cb237-4"><a href="day4.html#cb237-4" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb238"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb238-1"><a href="day4.html#cb238-1" aria-hidden="true" tabindex="-1"></a><span class="fu">get_sample_ci</span>(wt, <span class="dv">30</span>)</span></code></pre></div>
<pre><code>## [1] 1.272275 3.727725
## attr(,&quot;conf.level&quot;)
## [1] 0.95</code></pre>
<div class="sourceCode" id="cb240"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb240-1"><a href="day4.html#cb240-1" aria-hidden="true" tabindex="-1"></a>CIs <span class="ot">&lt;-</span> <span class="fu">map</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>, <span class="sc">~</span><span class="fu">get_sample_ci</span>(wt, <span class="dv">30</span>))</span></code></pre></div>
<div class="sourceCode" id="cb241"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb241-1"><a href="day4.html#cb241-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(CIs)</span></code></pre></div>
<pre><code>## [[1]]
## [1] 1.319300 4.147366
## attr(,&quot;conf.level&quot;)
## [1] 0.95
## 
## [[2]]
## [1] 1.55864 5.24136
## attr(,&quot;conf.level&quot;)
## [1] 0.95
## 
## [[3]]
## [1] 1.564104 4.502562
## attr(,&quot;conf.level&quot;)
## [1] 0.95
## 
## [[4]]
## [1] 1.402216 3.997784
## attr(,&quot;conf.level&quot;)
## [1] 0.95
## 
## [[5]]
## [1] 1.211124 2.588876
## attr(,&quot;conf.level&quot;)
## [1] 0.95
## 
## [[6]]
## [1] 2.414082 6.319252
## attr(,&quot;conf.level&quot;)
## [1] 0.95</code></pre>
<div class="sourceCode" id="cb243"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb243-1"><a href="day4.html#cb243-1" aria-hidden="true" tabindex="-1"></a><span class="co"># explain list subsetting</span></span>
<span id="cb243-2"><a href="day4.html#cb243-2" aria-hidden="true" tabindex="-1"></a>CIs[<span class="dv">1</span>]</span></code></pre></div>
<pre><code>## [[1]]
## [1] 1.319300 4.147366
## attr(,&quot;conf.level&quot;)
## [1] 0.95</code></pre>
<div class="sourceCode" id="cb245"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb245-1"><a href="day4.html#cb245-1" aria-hidden="true" tabindex="-1"></a>CIs[[<span class="dv">1</span>]]</span></code></pre></div>
<pre><code>## [1] 1.319300 4.147366
## attr(,&quot;conf.level&quot;)
## [1] 0.95</code></pre>
<div class="sourceCode" id="cb247"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb247-1"><a href="day4.html#cb247-1" aria-hidden="true" tabindex="-1"></a>CIs[[<span class="dv">1</span>]][<span class="dv">1</span>]</span></code></pre></div>
<pre><code>## [1] 1.3193</code></pre>
<div class="sourceCode" id="cb249"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb249-1"><a href="day4.html#cb249-1" aria-hidden="true" tabindex="-1"></a>test_ci <span class="ot">&lt;-</span> <span class="cf">function</span>(limits, true_mean) {</span>
<span id="cb249-2"><a href="day4.html#cb249-2" aria-hidden="true" tabindex="-1"></a>  limits[<span class="dv">1</span>] <span class="sc">&lt;</span> true_mean <span class="sc">&amp;</span> limits[<span class="dv">2</span>] <span class="sc">&gt;</span> true_mean</span>
<span id="cb249-3"><a href="day4.html#cb249-3" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb250"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb250-1"><a href="day4.html#cb250-1" aria-hidden="true" tabindex="-1"></a><span class="co"># sidenote</span></span>
<span id="cb250-2"><a href="day4.html#cb250-2" aria-hidden="true" tabindex="-1"></a><span class="co"># note difference between &amp; and &amp;&amp;</span></span>
<span id="cb250-3"><a href="day4.html#cb250-3" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="cn">TRUE</span>, <span class="cn">TRUE</span>) <span class="sc">&amp;</span>  <span class="fu">c</span>(<span class="cn">FALSE</span>, <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## [1] FALSE  TRUE</code></pre>
<div class="sourceCode" id="cb252"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb252-1"><a href="day4.html#cb252-1" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="cn">TRUE</span>, <span class="cn">TRUE</span>) <span class="sc">&amp;&amp;</span> <span class="fu">c</span>(<span class="cn">FALSE</span>, <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## [1] FALSE</code></pre>
<div class="sourceCode" id="cb254"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb254-1"><a href="day4.html#cb254-1" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">map_lgl</span>(CIs, test_ci, <span class="at">true_mean =</span> <span class="fu">mean</span>(wt))</span>
<span id="cb254-2"><a href="day4.html#cb254-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(results)</span></code></pre></div>
<pre><code>## [1]  TRUE  TRUE  TRUE  TRUE FALSE  TRUE</code></pre>
<div class="sourceCode" id="cb256"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb256-1"><a href="day4.html#cb256-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(results)</span></code></pre></div>
<pre><code>## [1] 0.936</code></pre>
<div class="sourceCode" id="cb258"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb258-1"><a href="day4.html#cb258-1" aria-hidden="true" tabindex="-1"></a><span class="co"># talk about organisation of code</span></span>
<span id="cb258-2"><a href="day4.html#cb258-2" aria-hidden="true" tabindex="-1"></a><span class="co"># source(&quot;test.R&quot;)</span></span></code></pre></div>
</div>
<div id="weitere-hinweise" class="section level4" number="4.7.1.5">
<h4><span class="header-section-number">4.7.1.5</span> Weitere Hinweise</h4>
<div class="sourceCode" id="cb259"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb259-1"><a href="day4.html#cb259-1" aria-hidden="true" tabindex="-1"></a><span class="co"># check out</span></span>
<span id="cb259-2"><a href="day4.html#cb259-2" aria-hidden="true" tabindex="-1"></a>?map</span>
<span id="cb259-3"><a href="day4.html#cb259-3" aria-hidden="true" tabindex="-1"></a><span class="co"># for the subtle differences between:</span></span>
<span id="cb259-4"><a href="day4.html#cb259-4" aria-hidden="true" tabindex="-1"></a><span class="fu">map</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>, <span class="sc">~</span> .x <span class="sc">+</span> <span class="dv">1</span>)</span></code></pre></div>
<pre><code>## [[1]]
## [1] 2
## 
## [[2]]
## [1] 3
## 
## [[3]]
## [1] 4
## 
## [[4]]
## [1] 5
## 
## [[5]]
## [1] 6
## 
## [[6]]
## [1] 7
## 
## [[7]]
## [1] 8
## 
## [[8]]
## [1] 9
## 
## [[9]]
## [1] 10
## 
## [[10]]
## [1] 11
## 
## [[11]]
## [1] 12
## 
## [[12]]
## [1] 13
## 
## [[13]]
## [1] 14
## 
## [[14]]
## [1] 15
## 
## [[15]]
## [1] 16
## 
## [[16]]
## [1] 17
## 
## [[17]]
## [1] 18
## 
## [[18]]
## [1] 19
## 
## [[19]]
## [1] 20
## 
## [[20]]
## [1] 21
## 
## [[21]]
## [1] 22
## 
## [[22]]
## [1] 23
## 
## [[23]]
## [1] 24
## 
## [[24]]
## [1] 25
## 
## [[25]]
## [1] 26
## 
## [[26]]
## [1] 27
## 
## [[27]]
## [1] 28
## 
## [[28]]
## [1] 29
## 
## [[29]]
## [1] 30
## 
## [[30]]
## [1] 31
## 
## [[31]]
## [1] 32
## 
## [[32]]
## [1] 33
## 
## [[33]]
## [1] 34
## 
## [[34]]
## [1] 35
## 
## [[35]]
## [1] 36
## 
## [[36]]
## [1] 37
## 
## [[37]]
## [1] 38
## 
## [[38]]
## [1] 39
## 
## [[39]]
## [1] 40
## 
## [[40]]
## [1] 41
## 
## [[41]]
## [1] 42
## 
## [[42]]
## [1] 43
## 
## [[43]]
## [1] 44
## 
## [[44]]
## [1] 45
## 
## [[45]]
## [1] 46
## 
## [[46]]
## [1] 47
## 
## [[47]]
## [1] 48
## 
## [[48]]
## [1] 49
## 
## [[49]]
## [1] 50
## 
## [[50]]
## [1] 51
## 
## [[51]]
## [1] 52
## 
## [[52]]
## [1] 53
## 
## [[53]]
## [1] 54
## 
## [[54]]
## [1] 55
## 
## [[55]]
## [1] 56
## 
## [[56]]
## [1] 57
## 
## [[57]]
## [1] 58
## 
## [[58]]
## [1] 59
## 
## [[59]]
## [1] 60
## 
## [[60]]
## [1] 61
## 
## [[61]]
## [1] 62
## 
## [[62]]
## [1] 63
## 
## [[63]]
## [1] 64
## 
## [[64]]
## [1] 65
## 
## [[65]]
## [1] 66
## 
## [[66]]
## [1] 67
## 
## [[67]]
## [1] 68
## 
## [[68]]
## [1] 69
## 
## [[69]]
## [1] 70
## 
## [[70]]
## [1] 71
## 
## [[71]]
## [1] 72
## 
## [[72]]
## [1] 73
## 
## [[73]]
## [1] 74
## 
## [[74]]
## [1] 75
## 
## [[75]]
## [1] 76
## 
## [[76]]
## [1] 77
## 
## [[77]]
## [1] 78
## 
## [[78]]
## [1] 79
## 
## [[79]]
## [1] 80
## 
## [[80]]
## [1] 81
## 
## [[81]]
## [1] 82
## 
## [[82]]
## [1] 83
## 
## [[83]]
## [1] 84
## 
## [[84]]
## [1] 85
## 
## [[85]]
## [1] 86
## 
## [[86]]
## [1] 87
## 
## [[87]]
## [1] 88
## 
## [[88]]
## [1] 89
## 
## [[89]]
## [1] 90
## 
## [[90]]
## [1] 91
## 
## [[91]]
## [1] 92
## 
## [[92]]
## [1] 93
## 
## [[93]]
## [1] 94
## 
## [[94]]
## [1] 95
## 
## [[95]]
## [1] 96
## 
## [[96]]
## [1] 97
## 
## [[97]]
## [1] 98
## 
## [[98]]
## [1] 99
## 
## [[99]]
## [1] 100
## 
## [[100]]
## [1] 101</code></pre>
<div class="sourceCode" id="cb261"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb261-1"><a href="day4.html#cb261-1" aria-hidden="true" tabindex="-1"></a><span class="co"># and</span></span>
<span id="cb261-2"><a href="day4.html#cb261-2" aria-hidden="true" tabindex="-1"></a>add_one <span class="ot">&lt;-</span> <span class="cf">function</span>(x) x <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb261-3"><a href="day4.html#cb261-3" aria-hidden="true" tabindex="-1"></a><span class="fu">map</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>, add_one)</span></code></pre></div>
<pre><code>## [[1]]
## [1] 2
## 
## [[2]]
## [1] 3
## 
## [[3]]
## [1] 4
## 
## [[4]]
## [1] 5
## 
## [[5]]
## [1] 6
## 
## [[6]]
## [1] 7
## 
## [[7]]
## [1] 8
## 
## [[8]]
## [1] 9
## 
## [[9]]
## [1] 10
## 
## [[10]]
## [1] 11
## 
## [[11]]
## [1] 12
## 
## [[12]]
## [1] 13
## 
## [[13]]
## [1] 14
## 
## [[14]]
## [1] 15
## 
## [[15]]
## [1] 16
## 
## [[16]]
## [1] 17
## 
## [[17]]
## [1] 18
## 
## [[18]]
## [1] 19
## 
## [[19]]
## [1] 20
## 
## [[20]]
## [1] 21
## 
## [[21]]
## [1] 22
## 
## [[22]]
## [1] 23
## 
## [[23]]
## [1] 24
## 
## [[24]]
## [1] 25
## 
## [[25]]
## [1] 26
## 
## [[26]]
## [1] 27
## 
## [[27]]
## [1] 28
## 
## [[28]]
## [1] 29
## 
## [[29]]
## [1] 30
## 
## [[30]]
## [1] 31
## 
## [[31]]
## [1] 32
## 
## [[32]]
## [1] 33
## 
## [[33]]
## [1] 34
## 
## [[34]]
## [1] 35
## 
## [[35]]
## [1] 36
## 
## [[36]]
## [1] 37
## 
## [[37]]
## [1] 38
## 
## [[38]]
## [1] 39
## 
## [[39]]
## [1] 40
## 
## [[40]]
## [1] 41
## 
## [[41]]
## [1] 42
## 
## [[42]]
## [1] 43
## 
## [[43]]
## [1] 44
## 
## [[44]]
## [1] 45
## 
## [[45]]
## [1] 46
## 
## [[46]]
## [1] 47
## 
## [[47]]
## [1] 48
## 
## [[48]]
## [1] 49
## 
## [[49]]
## [1] 50
## 
## [[50]]
## [1] 51
## 
## [[51]]
## [1] 52
## 
## [[52]]
## [1] 53
## 
## [[53]]
## [1] 54
## 
## [[54]]
## [1] 55
## 
## [[55]]
## [1] 56
## 
## [[56]]
## [1] 57
## 
## [[57]]
## [1] 58
## 
## [[58]]
## [1] 59
## 
## [[59]]
## [1] 60
## 
## [[60]]
## [1] 61
## 
## [[61]]
## [1] 62
## 
## [[62]]
## [1] 63
## 
## [[63]]
## [1] 64
## 
## [[64]]
## [1] 65
## 
## [[65]]
## [1] 66
## 
## [[66]]
## [1] 67
## 
## [[67]]
## [1] 68
## 
## [[68]]
## [1] 69
## 
## [[69]]
## [1] 70
## 
## [[70]]
## [1] 71
## 
## [[71]]
## [1] 72
## 
## [[72]]
## [1] 73
## 
## [[73]]
## [1] 74
## 
## [[74]]
## [1] 75
## 
## [[75]]
## [1] 76
## 
## [[76]]
## [1] 77
## 
## [[77]]
## [1] 78
## 
## [[78]]
## [1] 79
## 
## [[79]]
## [1] 80
## 
## [[80]]
## [1] 81
## 
## [[81]]
## [1] 82
## 
## [[82]]
## [1] 83
## 
## [[83]]
## [1] 84
## 
## [[84]]
## [1] 85
## 
## [[85]]
## [1] 86
## 
## [[86]]
## [1] 87
## 
## [[87]]
## [1] 88
## 
## [[88]]
## [1] 89
## 
## [[89]]
## [1] 90
## 
## [[90]]
## [1] 91
## 
## [[91]]
## [1] 92
## 
## [[92]]
## [1] 93
## 
## [[93]]
## [1] 94
## 
## [[94]]
## [1] 95
## 
## [[95]]
## [1] 96
## 
## [[96]]
## [1] 97
## 
## [[97]]
## [1] 98
## 
## [[98]]
## [1] 99
## 
## [[99]]
## [1] 100
## 
## [[100]]
## [1] 101</code></pre>
<div class="sourceCode" id="cb263"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb263-1"><a href="day4.html#cb263-1" aria-hidden="true" tabindex="-1"></a><span class="co"># and</span></span>
<span id="cb263-2"><a href="day4.html#cb263-2" aria-hidden="true" tabindex="-1"></a><span class="fu">map_dbl</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>, add_one)</span></code></pre></div>
<pre><code>##   [1]   2   3   4   5   6   7   8   9  10  11  12  13
##  [13]  14  15  16  17  18  19  20  21  22  23  24  25
##  [25]  26  27  28  29  30  31  32  33  34  35  36  37
##  [37]  38  39  40  41  42  43  44  45  46  47  48  49
##  [49]  50  51  52  53  54  55  56  57  58  59  60  61
##  [61]  62  63  64  65  66  67  68  69  70  71  72  73
##  [73]  74  75  76  77  78  79  80  81  82  83  84  85
##  [85]  86  87  88  89  90  91  92  93  94  95  96  97
##  [97]  98  99 100 101</code></pre>
<div class="sourceCode" id="cb265"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb265-1"><a href="day4.html#cb265-1" aria-hidden="true" tabindex="-1"></a><span class="co"># especially the meaning of ~ (speak: lambda)</span></span>
<span id="cb265-2"><a href="day4.html#cb265-2" aria-hidden="true" tabindex="-1"></a><span class="fu">map</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="sc">~</span> <span class="fu">print</span>(<span class="st">&quot;hi&quot;</span>))</span></code></pre></div>
<pre><code>## [1] &quot;hi&quot;
## [1] &quot;hi&quot;
## [1] &quot;hi&quot;
## [1] &quot;hi&quot;
## [1] &quot;hi&quot;</code></pre>
<pre><code>## [[1]]
## [1] &quot;hi&quot;
## 
## [[2]]
## [1] &quot;hi&quot;
## 
## [[3]]
## [1] &quot;hi&quot;
## 
## [[4]]
## [1] &quot;hi&quot;
## 
## [[5]]
## [1] &quot;hi&quot;</code></pre>
<div class="sourceCode" id="cb268"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb268-1"><a href="day4.html#cb268-1" aria-hidden="true" tabindex="-1"></a><span class="co"># more examples</span></span>
<span id="cb268-2"><a href="day4.html#cb268-2" aria-hidden="true" tabindex="-1"></a><span class="fu">map</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, paste, <span class="st">&quot;hi&quot;</span>)</span></code></pre></div>
<pre><code>## [[1]]
## [1] &quot;1 hi&quot;
## 
## [[2]]
## [1] &quot;2 hi&quot;
## 
## [[3]]
## [1] &quot;3 hi&quot;
## 
## [[4]]
## [1] &quot;4 hi&quot;
## 
## [[5]]
## [1] &quot;5 hi&quot;
## 
## [[6]]
## [1] &quot;6 hi&quot;
## 
## [[7]]
## [1] &quot;7 hi&quot;
## 
## [[8]]
## [1] &quot;8 hi&quot;
## 
## [[9]]
## [1] &quot;9 hi&quot;
## 
## [[10]]
## [1] &quot;10 hi&quot;</code></pre>
<div class="sourceCode" id="cb270"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb270-1"><a href="day4.html#cb270-1" aria-hidden="true" tabindex="-1"></a>is_even <span class="ot">&lt;-</span> <span class="cf">function</span>(x) x <span class="sc">%%</span> <span class="dv">2</span> <span class="sc">==</span> <span class="dv">0</span></span>
<span id="cb270-2"><a href="day4.html#cb270-2" aria-hidden="true" tabindex="-1"></a><span class="fu">map_lgl</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, is_even)</span></code></pre></div>
<pre><code>##  [1] FALSE  TRUE FALSE  TRUE FALSE  TRUE FALSE  TRUE
##  [9] FALSE  TRUE</code></pre>
<div class="sourceCode" id="cb272"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb272-1"><a href="day4.html#cb272-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Note: Often, you don&#39;t need a map function</span></span>
<span id="cb272-2"><a href="day4.html#cb272-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Because many functions in R are vectorised by default:</span></span>
<span id="cb272-3"><a href="day4.html#cb272-3" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span></span>
<span id="cb272-4"><a href="day4.html#cb272-4" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span></span>
<span id="cb272-5"><a href="day4.html#cb272-5" aria-hidden="true" tabindex="-1"></a><span class="co"># thus, just write</span></span>
<span id="cb272-6"><a href="day4.html#cb272-6" aria-hidden="true" tabindex="-1"></a>x <span class="sc">+</span> y</span></code></pre></div>
<pre><code>##  [1]  2  4  6  8 10 12 14 16 18 20</code></pre>
<div class="sourceCode" id="cb274"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb274-1"><a href="day4.html#cb274-1" aria-hidden="true" tabindex="-1"></a><span class="co"># instead of</span></span>
<span id="cb274-2"><a href="day4.html#cb274-2" aria-hidden="true" tabindex="-1"></a><span class="fu">map2_dbl</span>(x,y, <span class="st">`</span><span class="at">+</span><span class="st">`</span>)</span></code></pre></div>
<pre><code>##  [1]  2  4  6  8 10 12 14 16 18 20</code></pre>
</div>
</div>
<div id="veranschauliche-die-folgenden-konzepte-anhand-von-simulationen-auf-den-vorliegenden-daten" class="section level3" number="4.7.2">
<h3><span class="header-section-number">4.7.2</span> Veranschauliche die folgenden Konzepte anhand von Simulationen auf den vorliegenden Daten</h3>
<div id="sensitivity-wie-groß-ist-die-wahrscheinlichkeit-abhängig-von-der-sample-size-n-mit-einem-wilcoxon-rank-sum-test-tatsächlich-einen-p-value-0.05-zu-erhalten-wenn-ein-unterschied-existiert" class="section level4" number="4.7.2.1">
<h4><span class="header-section-number">4.7.2.1</span> Sensitivity: Wie groß ist die Wahrscheinlichkeit abhängig von der Sample Size n mit einem Wilcoxon Rank Sum Test tatsächlich einen p-value &lt;= 0.05 zu erhalten, wenn ein Unterschied existiert?</h4>
<ul>
<li>Ziehe 1000 mal ein Sample von 30 je aus wt und ko und teste
auf Signifikanz</li>
<li>Wie viele der 1000 Versuche sind statistisch signifikant?</li>
<li>Wie verändert sich diese Zahl, wenn 10 statt 30 gezogen werden?</li>
</ul>
</div>
<div id="lösung-2" class="section level4" number="4.7.2.2">
<h4><span class="header-section-number">4.7.2.2</span> Lösung</h4>
<div class="sourceCode" id="cb276"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb276-1"><a href="day4.html#cb276-1" aria-hidden="true" tabindex="-1"></a>test_samle_wilcox <span class="ot">&lt;-</span> <span class="cf">function</span>(n) {</span>
<span id="cb276-2"><a href="day4.html#cb276-2" aria-hidden="true" tabindex="-1"></a>  draw_wt <span class="ot">&lt;-</span> <span class="fu">sample</span>(wt, n, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb276-3"><a href="day4.html#cb276-3" aria-hidden="true" tabindex="-1"></a>  draw_ko <span class="ot">&lt;-</span> <span class="fu">sample</span>(ko, n, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb276-4"><a href="day4.html#cb276-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">wilcox.test</span>(draw_wt, draw_ko, <span class="at">exact =</span> <span class="cn">FALSE</span>)<span class="sc">$</span>p.value</span>
<span id="cb276-5"><a href="day4.html#cb276-5" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb277"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb277-1"><a href="day4.html#cb277-1" aria-hidden="true" tabindex="-1"></a>many_p_values <span class="ot">&lt;-</span> <span class="fu">map_dbl</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>, <span class="sc">~</span><span class="fu">test_samle_wilcox</span>(<span class="dv">30</span>))</span></code></pre></div>
<div class="sourceCode" id="cb278"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb278-1"><a href="day4.html#cb278-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(many_p_values)</span></code></pre></div>
<p><img src="dataIntro19_files/figure-html/unnamed-chunk-172-1.svg" width="672" /></p>
<div class="sourceCode" id="cb279"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb279-1"><a href="day4.html#cb279-1" aria-hidden="true" tabindex="-1"></a>many_p_values <span class="ot">&lt;-</span> <span class="fu">map_dbl</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>, <span class="sc">~</span><span class="fu">test_samle_wilcox</span>(<span class="dv">10</span>))</span></code></pre></div>
<div class="sourceCode" id="cb280"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb280-1"><a href="day4.html#cb280-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(many_p_values)</span></code></pre></div>
<p><img src="dataIntro19_files/figure-html/unnamed-chunk-174-1.svg" width="672" /></p>
<div class="sourceCode" id="cb281"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb281-1"><a href="day4.html#cb281-1" aria-hidden="true" tabindex="-1"></a>many_p_values <span class="ot">&lt;-</span> <span class="fu">map_dbl</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>, <span class="sc">~</span><span class="fu">test_samle_wilcox</span>(<span class="dv">4</span>))</span></code></pre></div>
<div class="sourceCode" id="cb282"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb282-1"><a href="day4.html#cb282-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(many_p_values)</span></code></pre></div>
<p><img src="dataIntro19_files/figure-html/unnamed-chunk-176-1.svg" width="672" /></p>
<div class="sourceCode" id="cb283"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb283-1"><a href="day4.html#cb283-1" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">=</span> <span class="fl">0.05</span></span>
<span id="cb283-2"><a href="day4.html#cb283-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(many_p_values <span class="sc">&lt;=</span> alpha)</span></code></pre></div>
<pre><code>## [1] 0.642</code></pre>
<div class="sourceCode" id="cb285"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb285-1"><a href="day4.html#cb285-1" aria-hidden="true" tabindex="-1"></a><span class="co"># talk about power, effect size, difference between wilcox and t-test</span></span></code></pre></div>
</div>
<div id="specificity-unter-der-voraussetzung-dass-kein-unterschied-zwischen-den-bedingungen-vorliegt-wie-groß-ist-die-wahrscheinlichkeit-dennoch-ein-statistisch-signifikantes-ergebnis-zu-erhalten" class="section level4" number="4.7.2.3">
<h4><span class="header-section-number">4.7.2.3</span> Specificity: Unter der Voraussetzung, dass <strong>kein</strong> Unterschied zwischen den Bedingungen vorliegt, wie groß ist die Wahrscheinlichkeit, dennoch ein statistisch signifikantes Ergebnis zu erhalten?</h4>
<ul>
<li>Stell dir vor, alle Zellen seien wie wt-Zellen</li>
<li>Ziehe zwei mal 30 aus den wt-Zellen und lasse einen
Wilcoxon Rank Sum Test laufen</li>
<li>Widerhole das das Prozedere 1000 mal</li>
<li>Wie oft ist das Ergebnis statistisch signifikant?</li>
</ul>
</div>
<div id="lösung-3" class="section level4" number="4.7.2.4">
<h4><span class="header-section-number">4.7.2.4</span> Lösung</h4>
<div class="sourceCode" id="cb286"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb286-1"><a href="day4.html#cb286-1" aria-hidden="true" tabindex="-1"></a>test_same_wilcox <span class="ot">&lt;-</span> <span class="cf">function</span>(n) {</span>
<span id="cb286-2"><a href="day4.html#cb286-2" aria-hidden="true" tabindex="-1"></a>  draw_wt <span class="ot">&lt;-</span> <span class="fu">sample</span>(wt, n, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb286-3"><a href="day4.html#cb286-3" aria-hidden="true" tabindex="-1"></a>  draw_ko <span class="ot">&lt;-</span> <span class="fu">sample</span>(wt, n, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb286-4"><a href="day4.html#cb286-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">wilcox.test</span>(draw_wt, draw_ko, <span class="at">exact =</span> <span class="cn">FALSE</span>)<span class="sc">$</span>p.value</span>
<span id="cb286-5"><a href="day4.html#cb286-5" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb287"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb287-1"><a href="day4.html#cb287-1" aria-hidden="true" tabindex="-1"></a>many_p_values <span class="ot">&lt;-</span> <span class="fu">map_dbl</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>, <span class="sc">~</span><span class="fu">test_same_wilcox</span>(<span class="dv">30</span>))</span></code></pre></div>
<div class="sourceCode" id="cb288"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb288-1"><a href="day4.html#cb288-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(many_p_values)</span></code></pre></div>
<p><img src="dataIntro19_files/figure-html/unnamed-chunk-181-1.svg" width="672" /></p>
<div class="sourceCode" id="cb289"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb289-1"><a href="day4.html#cb289-1" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">=</span> <span class="fl">0.05</span></span>
<span id="cb289-2"><a href="day4.html#cb289-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(many_p_values <span class="sc">&lt;=</span> alpha)</span></code></pre></div>
<pre><code>## [1] 0.065</code></pre>
<div class="sourceCode" id="cb291"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb291-1"><a href="day4.html#cb291-1" aria-hidden="true" tabindex="-1"></a><span class="co"># this is what we would expect from p-values!</span></span></code></pre></div>
</div>
<div id="resource-zu-p-value-histogrammen" class="section level4" number="4.7.2.5">
<h4><span class="header-section-number">4.7.2.5</span> Resource zu p-value Histogrammen</h4>
<p><a href="http://varianceexplained.org/statistics/interpreting-pvalue-histogram/" class="uri">http://varianceexplained.org/statistics/interpreting-pvalue-histogram/</a></p>

</div>
</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="day3.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="day5.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook/js/app.min.js"></script>
<script src="libs/gitbook/js/lunr.js"></script>
<script src="libs/gitbook/js/clipboard.min.js"></script>
<script src="libs/gitbook/js/plugin-search.js"></script>
<script src="libs/gitbook/js/plugin-sharing.js"></script>
<script src="libs/gitbook/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook/js/plugin-bookdown.js"></script>
<script src="libs/gitbook/js/jquery.highlight.js"></script>
<script src="libs/gitbook/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
